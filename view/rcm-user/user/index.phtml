<?php
?>
<pre>
<?php
/* ACL STUFF
$x = $this->isAllowed('pants', 'wear');

$u = $this->zfcUserIdentity();

var_dump($u);

$acl = new Acl();
*/
//$userService = new RcmUser\Service\RcmUserService();
//var_dump($userService->getUserInputFilter()); die;

$user = $userService->buildNewUser();

$user->setId('f11653b8-2a4a-4784-a70b-ac7641b46c28');
$user->setUsername('Jerry13');
$user->setPassword('12345678');

echo "**INITIAL USER OBJECT:\n";
var_dump($user);


/* CRUD ***********************************/
/* CREATE *
$result = $userService->createUser($user);

echo "**After create:\n";
if(!$result->isSuccess()){

    echo "ERROR: ";
    var_dump($result->getMessages());
}

var_dump($result->getUser());
/* */

/* READ */
$result = $userService->readUser($user);

echo "READ: After read:\n";
if(!$result->isSuccess()){

    echo "ERROR: ";
    var_dump($result->getMessages());
}

var_dump($result->getUser());
/* */

/* UPDATE */
$result = $userService->updateUser($user);

echo "UPDATE: After update:\n";
if(!$result->isSuccess()){

    echo "ERROR: ";
    var_dump($result->getMessages());
}

var_dump($result->getUser());
/* */

/* DELETE *
$result = $userService->deleteUser($user);

echo "**After delete:\n";
if(!$result->isSuccess()){

    echo "ERROR: ";
    var_dump($result->getMessages());
}

var_dump($result->getUser());
/* */

/* */


/* AUTH ***********************************/

/* AUTH CHECK */
$authResult = $userService->validateCredentials($user);

echo "AUTH CHECK Result: ".var_export($authResult->isValid(), true)."\n";
var_dump($authResult);
/* */

/*  LOG IN */
$authResult = $userService->authenticate($user);

echo "LOG IN Result: " . var_export($authResult->isValid(), true) . "\n";
var_dump($authResult);
/* */

/* GET SESSION USER */
echo "GET SESSION USER: \n";
var_dump($userService->getIdentity());
/* */

/*  LOG OUT */
$userService->clearIdentity();

echo "LOG OUT: Session user after log out: \n";
var_dump($userService->getIdentity());

/* */

/* ACL ************************************/
echo "User Roles: ";
$currentUser = $userService->getIdentity();
if (!empty($currentUser)) {
    var_dump($currentUser->getProperty('RcmUser\Acl\UserRoles', 'NOT SET'));
} else {
    echo "NOT LOGGED IN\n";
}

/* ACL */

/* ACL VALUES */
echo "ACL Roles: ";
var_dump($bjyAuthService->getAcl()->getRoles());

echo "ACL Resources: ";
var_dump($bjyAuthService->getAcl()->getResources());

//echo "ACL Rules: ";
//var_dump($bjyAuthService);
/* */

/* ACL CHECK */
$resource = 'RcmUserAccess'; // parent
$privilage = 'read'; // child
echo "ACL CHECK: ->isAllowed($resource, $privilage) = ";
var_export($this->isAllowed($resource, $privilage));
/* */

?>




</pre>